# 1. Webpack

Webpack은 각기 다른 Asset 처리를 도와주므로 
우린 TS와 JS만 다루면 됩니다.

참고 : https://webpack.js.org/guides

<br><br>

# 2. 프로젝트 설정하기

### 1. init, install
```sh
tsc --init

npm init -y

npm install lite-server

npm install lodash

npm install --save-dev @type/loadsh
```

### 2. tsconfig.json 수정
```json
"include": ["src"]

"outDir": "./dist",

"target": "ES6",

"module": "ES2015",
```

### 3. src/index.ts
```js
import Dog from "./Dog.js";
import ShelterDog from "./ShelterDog.js";
import { add, multiply, divide } from "./utils.js";

const elton = new Dog("Elton", "Aussie", 0.5);
elton.bark();

console.log(add(4, 5));
console.log(multiply(4, 5));
console.log(divide(4, 5));

const buffy = new ShelterDog("Buffy", "Pitbull", 5, "Desert Springs Shelter");
```

### 4. src/utils.ts
```ts
import _ from "lodash";

export const add = (x: number, y:number) => {
    return _.add(x, y);
}

export const multiply = (x: number, y:number) => {
    return x * y;
}

export const divide = (x: number, y:number) => {
    return x / y;
}
```

### 5. src/Dog.ts
```ts
export default class Dog {
    constructor(public name: string, public breed: string, public age: number) {}
    bark() {
        console.log("WOOF WOOF!!");
    }
}
```

### 6. src/ShelterDog.ts
```ts
import Dog from "./Dog.js";

export default class ShelterDog extends Dog {
    constructor(
        name: string,
        breed: string,
        age: number,
        public shelter: string
    ) {
        super(name, breed, age);
    }
}
```

### 7. index.html
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webpack</title>
</head>
<body>
    <!-- script 추가 -->
    <script type="module" src="dist/index.js"></script>
</body>
</html>
```

### 8. ts 실행
```shell
tsc -w
```

### 9. package.json
```json
// 서버 실행을 위한 script 추가.
"scripts": {
    "start": "lite-server"
},
```
### 10. start
```sh
npm start
```





<br><br>


# 3. Webpack 의존성 설치하기

webpack 설치
```shell
npm install --save-dev webpack webpack-cli typescript ts-loader
```

<br>

### 1. webpack
Webpack: 모듈 번들러

<br>

### 2. webpack-cli
Webpack을 명령줄에서 사용하거나 package.json 파일 내에서 호출하려면
webpack-cli가 필요합니다.

<br>

### 3. typescript
typescript를 다시 설치하는 이유는 package.json에 TypeScript를 포함시키는 것이 모범 사례이기 때문이다.
지금 이 순간에 우리가 이 버전을 사용하고 있음을 확실히 표시해서
이후에 누군가 다운로드하면 TS를 사용해야함을 알게된다.

(다른 사람과 공유하는 경우에는 개별 패키지에 전역에 TypeScript설치는 사용하지 않는다.)

<br>

### 4. ts-loader

TypeScript와 Webpack의 중간자 역할을 한다.

tsc 명령어를 호출 -> TS를 JS로 컴파일링 한 뒤
--> 이를 모두 번들링하게 될 Webpack으로 전달하는 역할

<br><br>

# 4. Webpack 기초 구성

### 1. webpack.config.js 만들기

<br>

### 2. webpack.config.js 설정
```js
// 참고 : https://webpack.js.org/guides/typescript/ 의 webpack.config.js

const path = require("path");

module.exports = {
    // 설정이 들어갈 부분
    // 0. mode 설정
    mode: "development",
    // 1. entry point: Webpack에게 번들링을 시작할 애플리케이션 시작지점을 지정
    entry: "./src/index.ts",
    // 2. module
    module: {
        // rules: 규칙 추가
        rules: [
            {
                test: /\tsx?$/, // .ts, .tsx
                use: "ts-loader", // 무엇을 사용할지
                exclude: /node_modules/ 
            },
        ],
    },
    // 3. resolve: 
    resolve: {
        // extension: Webpack이 resolve할 수 있는 확장자의 리스트
        extensions: [".tsx", ".ts", ".js"],
    },
    // 4. output: Webpack으로 생성하려는 출력
    output: {
        filename: "bundle.js", // bundle.js이라는 파일을 생성하고
        path: path.resolve(__dirname, "dist"), // dist폴더 안에 넣으라고 지시하는 것
    }
}
```

<br>

### 3. package.json 수정
```json
"scripts": {
    "start": "lite-server",
    "build": "webpack" // 추가
  },
```

<br>

### 4. npm build 실행
```shell
npm run build
```

<br>

### 5. dist폴더의 파일을 모두 지우고
다시 한 번 npm run build를 실행하면 
dist폴더에 bundle.js가 생긴다.

<br>

### 6. bundle.js를 사용하기 위해 index.html내에서 연결하기
index.html
```html
<!-- <script type="module" src="dist/index.js"></script> -->
<script type="module" src="dist/bundle.js"></script>
```

<br>

### 7. 서버를 실행해서 확인하기
```sh
npm start
```

> src의 모든 ts파일들이  가져오기/내보내기와 공유된 코드들이 모두 컴파일링되어 
> dist의 아주 작은 단일 파일인 bundle.js로 번들링이 되었다.


